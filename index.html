<!DOCTYPE HTML>
<!--
	Future Imperfect by HTML5 UP (visuals kept)
	Merged with Boligo Firebase login/registration modal + sidebar links
-->
<html>
	<head>
		<title>Boligo – Forside</title>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
		<link rel="stylesheet" href="assets/css/main.css" />
		<style>
			/* Modal styles adapted to match the template */
			#loginModal {
			  display: none;
			  position: fixed;
			  z-index: 10000;
			  left: 0; top: 0;
			  width: 100%; height: 100%;
			  background: rgba(0,0,0,0.6);
			  justify-content: center;
			  align-items: center;
			}
			#loginModal .modal-window {
			  background: #fff;
			  width: 380px;
			  max-width: 92%;
			  border-radius: 8px;
			  box-shadow: 0 10px 30px rgba(0,0,0,0.4);
			  padding: 22px;
			  font-family: inherit;
			}
			#loginModal h2 { margin: 0 0 12px 0; font-size: 1.15rem; }
			#loginModal .input {
			  width: 100%;
			  padding: 10px 12px;
			  margin: 8px 0;
			  border-radius: 6px;
			  border: 1px solid #ddd;
			  font-size: 0.95rem;
			}
			#loginModal .button-primary {
			  width: 100%;
			  padding: 10px 12px;
			  margin-top: 8px;
			  border-radius: 6px;
			  background: #007bff;
			  color: #fff;
			  border: none;
			  cursor: pointer;
			  font-weight: 600;
			}
			#loginModal .button-primary:hover { background: #005ecb; }
			#loginModal .small-btn {
			  display:inline-block;
			  margin-top:10px;
			  text-decoration: none;
			  color:#666;
			  cursor:pointer;
			}
			#loginMessage { margin-top:10px; min-height:20px; color:#333; font-size:0.95rem; }

			/* Make the template header login link visible */
			.header-login {
			  cursor: pointer;
			  display:inline-block;
			  padding:6px 8px;
			}

			/* Slight styling for Boligo sidebar inside template */
			#sidebar .boligo-menu {
			  list-style: none;
			  padding: 0;
			  margin-top: 12px;
			}
			#sidebar .boligo-menu li { margin: 10px 0; }
			#sidebar .boligo-menu a {
			  text-decoration: none;
			  color: #333;
			  display:block;
			  font-weight:500;
			  padding:6px 8px;
			  border-radius:6px;
			}
			#sidebar .boligo-menu a:hover { background: rgba(0,0,0,0.04); }
		</style>
	</head>
	<body class="is-preload">

		<!-- Wrapper -->
			<div id="wrapper">

				<!-- Header -->
					<header id="header">
						<h1><a href="index.html">Boligo</a></h1>

						<!-- Keep original template links (left) -->
						<nav class="links">
							<ul>
								<li><a href="#">Lorem</a></li>
								<li><a href="#">Ipsum</a></li>
								<li><a href="#">Feugiat</a></li>
								<li><a href="#">Tempus</a></li>
								<li><a href="#">Adipiscing</a></li>
							</ul>
						</nav>

						<!-- Main (search + menu) - replace Menu action with Login trigger (top header) -->
						<nav class="main">
							<ul>
								<li class="search">
									<a class="fa-search" href="#search">Search</a>
									<form id="search" method="get" action="#">
										<input type="text" name="query" placeholder="Search" />
									</form>
								</li>
								<li>
									<!-- Keep template menu icon -->
									<a class="fa-bars" href="#menu">Menu</a>
								</li>

								<!-- Boligo login in the top header -->
								<li>
									<span class="header-login" id="headerLoginBtn">Log In</span>
								</li>
							</ul>
						</nav>
					</header>

				<!-- Menu -->
					<section id="menu">
						<!-- Search -->
							<section>
								<form class="search" method="get" action="#">
									<input type="text" name="query" placeholder="Search" />
								</form>
							</section>

						<!-- Links -->
							<section>
								<ul class="links">
									<li>
										<a href="#">
											<h3>Lorem ipsum</h3>
											<p>Feugiat tempus veroeros dolor</p>
										</a>
									</li>
									<li>
										<a href="#">
											<h3>Dolor sit amet</h3>
											<p>Sed vitae justo condimentum</p>
										</a>
									</li>
									<li>
										<a href="#">
											<h3>Feugiat veroeros</h3>
											<p>Phasellus sed ultricies mi congue</p>
										</a>
									</li>
									<li>
										<a href="#">
											<h3>Etiam sed consequat</h3>
											<p>Porta lectus amet ultricies</p>
										</a>
									</li>
								</ul>
							</section>

						<!-- Actions -->
							<section>
								<ul class="actions stacked">
									<li><a href="#" class="button large" id="menuLoginBtn">Log In</a></li>
								</ul>
							</section>
					</section>

				<!-- Main -->
					<div id="main">

						<!-- Post (kept template content) -->
							<article class="post">
								<header>
									<div class="title">
										<h2><a href="single.html">Utforsk</a></h2>
										<p></p>
									</div>
									<div class="meta">
										<time class="published" datetime="2015-11-01">2025</time>
										<a href="#" class="author"><span class="name">Ludvik</span><img src="images/avatar.jpg" alt="" /></a>
									</div>
								</header>
								<a href="single.html" class="image featured"><img src="images/pic01.jpg" alt="" /></a>
								<p>Mauris neque quam, fermentum ut nisl vitae, convallis maximus nisl. Sed mattis nunc id lorem euismod placerat...</p>
								<footer>
									<ul class="actions">
										<li><a href="single.html" class="button large">Continue Reading</a></li>
									</ul>
									<ul class="stats">
										<li><a href="#">General</a></li>
										<li><a href="#" class="icon solid fa-heart">28</a></li>
										<li><a href="#" class="icon solid fa-comment">128</a></li>
									</ul>
								</footer>
							</article>

						<!-- (other posts kept) -->

						<!-- Pagination -->
							<ul class="actions pagination">
								<li><a href="" class="disabled button large previous">Previous Page</a></li>
								<li><a href="#" class="button large next">Next Page</a></li>
							</ul>

					</div>

				<!-- Sidebar -->
					<section id="sidebar">

						<!-- Intro (replaced with your Boligo sidebar content) -->
							<section id="intro">
								<a href="index.html" class="logo"><img src="Bilder/BoligoLogo.png" alt="Boligo logo" style="width 220px; max-width:220px;" /></a>
								<header>
									<h2>Boligo</h2>
									<p>Finn, del og utforsk boliger i ditt område.</p>
								</header>

								<!-- Your sidebar menu -->
								<ul class="boligo-menu">
									<li><a href="index.html">Hjem</a></li>
									<li><a href="sok.html">Søk</a></li>
									<li><a href="kart.html">Kart</a></li>
									<li><a href="profil.html">Profil</a></li>
								</ul>
							</section>

						<!-- Mini Posts (kept template) -->
							<section>
								<div class="mini-posts">
									<!-- Mini posts kept as-is -->
									<article class="mini-post">
										<header>
											<h3><a href="single.html">Vitae sed condimentum</a></h3>
											<time class="published" datetime="2015-10-20">October 20, 2015</time>
											<a href="#" class="author"><img src="images/avatar.jpg" alt="" /></a>
										</header>
										<a href="single.html" class="image"><img src="images/pic04.jpg" alt="" /></a>
									</article>
									<!-- additional mini posts... -->
								</div>
							</section>

						<!-- Posts List (kept) -->
							<section>
								<ul class="posts">
									<li>
										<article>
											<header>
												<h3><a href="single.html">Lorem ipsum fermentum ut nisl vitae</a></h3>
												<time class="published" datetime="2015-10-20">October 20, 2015</time>
											</header>
											<a href="single.html" class="image"><img src="images/pic08.jpg" alt="" /></a>
										</article>
									</li>
									<!-- more posts -->
								</ul>
							</section>

						<!-- About -->
							<section class="blurb">
								<h2>About</h2>
								<p>Mauris neque quam, fermentum ut nisl vitae, convallis maximus nisl. Sed mattis nunc id lorem euismod amet placerat.</p>
								<ul class="actions">
									<li><a href="#" class="button">Learn More</a></li>
								</ul>
							</section>

						<!-- Footer -->
							<section id="footer">
								<ul class="icons">
									<li><a href="#" class="icon brands fa-twitter"><span class="label">Twitter</span></a></li>
									<li><a href="#" class="icon brands fa-facebook-f"><span class="label">Facebook</span></a></li>
									<li><a href="#" class="icon brands fa-instagram"><span class="label">Instagram</span></a></li>
									<li><a href="#" class="icon solid fa-rss"><span class="label">RSS</span></a></li>
									<li><a href="#" class="icon solid fa-envelope"><span class="label">Email</span></a></li>
								</ul>
								<p class="copyright">&copy; Boligo. Design: HTML5 UP.</p>
							</section>

					</section>

			</div>

		<!-- Boligo Login / Register Modal -->
		<div id="loginModal" aria-hidden="true">
		  <div class="modal-window" role="dialog" aria-modal="true" aria-labelledby="modalTitle">
		    <h2 id="modalTitle">Login</h2>

		    <!-- Login form -->
		    <input id="loginEmail" class="input" type="email" placeholder="Email" autocomplete="username" />
		    <input id="loginPassword" class="input" type="password" placeholder="Passord" autocomplete="current-password" />
		    <button class="button-primary" id="loginBtn">Login</button>

		    <hr />

		    <h2>Registrer</h2>
		    <input id="registerEmail" class="input" type="email" placeholder="Email" autocomplete="email" />
		    <input id="registerPassword" class="input" type="password" placeholder="Passord (minst 6 tegn)" autocomplete="new-password" />
		    <input id="registerUsername" class="input" type="text" placeholder="Brukernavn" autocomplete="name" />
		    <button class="button-primary" id="registerBtn">Register</button>

		    <p id="loginMessage" aria-live="polite"></p>

		    <div style="display:flex; gap:8px; margin-top:8px;">
		      <button class="small-btn" id="closeModalBtn">Lukk</button>
		      <a class="small-btn" id="switchToRegister">Gå til registrering</a>
		      <a class="small-btn" id="switchToLogin">Gå til login</a>
		    </div>
		  </div>
		</div>

		<!-- Scripts (template scripts kept) -->
			<script src="assets/js/jquery.min.js"></script>
			<script src="assets/js/browser.min.js"></script>
			<script src="assets/js/breakpoints.min.js"></script>
			<script src="assets/js/util.js"></script>
			<script src="assets/js/main.js"></script>

		<!-- Firebase + modal behavior (module) -->
		<script type="module">
		  // Firebase imports (modular)
		  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.4/firebase-app.js";
		  import {
		    getAuth, createUserWithEmailAndPassword,
		    signInWithEmailAndPassword, onAuthStateChanged
		  } from "https://www.gstatic.com/firebasejs/10.12.4/firebase-auth.js";
		  import {
		    getFirestore, doc, setDoc, getDoc
		  } from "https://www.gstatic.com/firebasejs/10.12.4/firebase-firestore.js";

		  // Firebase config (from your code)
		  const firebaseConfig = {
		    apiKey: "AIzaSyBDlQaQ4xhIlHO_HpzfOu7UIxPa_ob-QZg",
		    authDomain: "boligo-login.firebaseapp.com",
		    projectId: "boligo-login",
		    storageBucket: "boligo-login.appspot.com",
		    messagingSenderId: "39402990294",
		    appId: "1:39402990294:web:abb90e8eeccadeb178b777",
		    measurementId: "G-T7C7TK75KC"
		  };

		  // Initialize Firebase
		  const app = initializeApp(firebaseConfig);
		  const auth = getAuth(app);
		  const db = getFirestore(app);

		  // Modal controls
		  const loginModal = document.getElementById("loginModal");
		  const headerLoginBtn = document.getElementById("headerLoginBtn");
		  const menuLoginBtn = document.getElementById("menuLoginBtn");
		  const closeModalBtn = document.getElementById("closeModalBtn");
		  const loginBtn = document.getElementById("loginBtn");
		  const registerBtn = document.getElementById("registerBtn");
		  const messageEl = document.getElementById("loginMessage");
		  const switchToRegister = document.getElementById("switchToRegister");
		  const switchToLogin = document.getElementById("switchToLogin");

		  // open / close
		  function openLogin() {
		    loginModal.style.display = "flex";
		    loginModal.setAttribute("aria-hidden", "false");
		  }
		  function closeLogin() {
		    loginModal.style.display = "none";
		    loginModal.setAttribute("aria-hidden", "true");
		    messageEl.innerText = "";
		  }

		  // Hook UI triggers
		  headerLoginBtn.addEventListener("click", openLogin);
		  menuLoginBtn.addEventListener("click", (e) => { e.preventDefault(); openLogin(); });
		  closeModalBtn.addEventListener("click", closeLogin);

		  // click outside modal to close
		  window.addEventListener("click", (evt) => {
		    if (evt.target === loginModal) closeLogin();
		  });

		  // Prevent Enter key from submitting or reloading
		  document.querySelectorAll("#loginModal input").forEach(input => {
		    input.addEventListener("keypress", (e) => {
		      if (e.key === "Enter") e.preventDefault();
		    });
		  });

		  // Switch helper (focus convenience)
		  switchToRegister.addEventListener("click", () => {
		    document.getElementById("registerEmail").focus();
		  });
		  switchToLogin.addEventListener("click", () => {
		    document.getElementById("loginEmail").focus();
		  });

		  // Registration
		  registerBtn.addEventListener("click", async () => {
		    const email = document.getElementById("registerEmail").value.trim();
		    const password = document.getElementById("registerPassword").value.trim();
		    const username = document.getElementById("registerUsername").value.trim();

		    if (!username) {
		      messageEl.innerText = "⚠️ Du må skrive et brukernavn.";
		      return;
		    }
		    if (!email || !password) {
		      messageEl.innerText = "⚠️ Skriv epost og passord.";
		      return;
		    }
		    if (password.length < 6) {
		      messageEl.innerText = "⚠️ Passordet må være minst 6 tegn.";
		      return;
		    }

		    try {
		      messageEl.innerText = "⏳ Registrerer...";
		      const userCred = await createUserWithEmailAndPassword(auth, email, password);
		      const user = userCred.user;

		      // Create Firestore document for this user
		      await setDoc(doc(db, "users", user.uid), {
		        email: user.email,
		        username: username,
		        fullname: "",
		        profilePic: "",
		        followers: [],
		        following: [],
		        images: []
		      });

		      messageEl.innerText = "✅ Registrering fullført! Omdirigerer...";
		      // small delay so user sees the message, then redirect
		      setTimeout(() => { window.location.href = "profil.html"; }, 700);
		    } catch (err) {
		      console.error(err);
		      messageEl.innerText = "❌ " + err.message;
		    }
		  });

		  // Login
		  loginBtn.addEventListener("click", async () => {
		    const email = document.getElementById("loginEmail").value.trim();
		    const password = document.getElementById("loginPassword").value.trim();

		    if (!email || !password) {
		      messageEl.innerText = "⚠️ Fyll inn epost og passord.";
		      return;
		    }

		    try {
		      messageEl.innerText = "⏳ Logger inn...";
		      await signInWithEmailAndPassword(auth, email, password);
		      messageEl.innerText = "✅ Logget inn! Omdirigerer...";
		      setTimeout(() => { window.location.href = "profil.html"; }, 600);
		    } catch (err) {
		      console.error(err);
		      messageEl.innerText = "❌ " + err.message;
		    }
		  });

		  // Auto detect logged-in user and ensure Firestore doc exists
		  onAuthStateChanged(auth, async (user) => {
		    if (user) {
		      console.log("✅ Logged in as:", user.email);
		      const docRef = doc(db, "users", user.uid);
		      const docSnap = await getDoc(docRef);
		      if (!docSnap.exists()) {
		        await setDoc(docRef, {
		          email: user.email,
		          username: user.email.split("@")[0],
		          fullname: "",
		          profilePic: "",
		          followers: [],
		          following: [],
		          images: []
		        });
		      }
		      // Optionally redirect if already authenticated and on public page:
		      // window.location.href = "profil.html";
		    } else {
		      console.log("No user logged in");
		    }
		  });

		</script>

	</body>
</html>

